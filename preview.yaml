version: "1"
services:
  backend:
    # Use the existing backend folder
    working_dir: ./mood_log_backend
    # Explicitly run our preview script (CI-friendly, installs deps, runs npm start)
    # IMPORTANT: This is a Node.js service; do not change to any Python/uvicorn/FastAPI command.
    start: "bash preview_start.sh"
    env:
      - PORT=3001
    # Optionally expose the port mapping information for preview systems
    ports:
      - "3001:3001"
# Fallback command mapping for preview runners that ignore working_dir/start above:
# This ensures we never run a Python/uvicorn command.
commands:
  backend:
    run: "cd mood_log_backend && bash preview_start.sh"
